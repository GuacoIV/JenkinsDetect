<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="118,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T65U3">c</span>=melcepst(<span class="var type1" id="S3T1U6">s</span>,<span class="var type1" id="S4T2U7">fs</span>,<span class="mxinfo" id="T8:U4"><span class="var type2" id="S5T8V5U8">w</span></span>,<span class="mxinfo" id="T2:U6"><span class="var type2" id="S6T2V6U9">nc</span></span>,<span class="var type1" id="S7T2U10">p</span>,<span class="mxinfo" id="T2:U9"><span class="var type2" id="S8T2V2U11">n</span></span>,<span class="mxinfo" id="T2:U11"><span class="var type2" id="S9T2V1U12">inc</span></span>,<span class="mxinfo" id="T2:U13"><span class="var type2" id="S10T2V3U13">fl</span></span>,<span class="mxinfo" id="T2:U15"><span class="var type2" id="S11T2V4U14">fh</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%MELCEPST Calculate the mel cepstrum of a signal C=(S,FS,W,NC,P,N,INC,FL,FH)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Simple use: (1) c=melcepst(s,fs)          % calculate mel cepstrum with 12 coefs, 256 sample frames</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%             (2) c=melcepst(s,fs,'e0dD')   % include log energy, 0th cepstral coef, delta and delta-delta coefs</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%     s   speech signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%     fs  sample rate in Hz (default 11025)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%     w   mode string (see below)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%     nc  number of cepstral coefficients excluding 0'th coefficient [default 12]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%     p   number of filters in filterbank [default: floor(3*log(fs)) =  approx 2.1 per ocatave]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%     n   length of frame in samples [default power of 2 &lt; (0.03*fs)]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%     inc frame increment [default n/2]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%     fl  low end of the lowest filter as a fraction of fs [default = 0]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%     fh  high end of highest filter as a fraction of fs [default = 0.5]</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%       w   any sensible combination of the following:</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%               'R'  rectangular window in time domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%               'N'  Hanning window in time domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%               'M'  Hamming window in time domain (default)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%               't'  triangular shaped filters in mel domain (default)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%               'n'  hanning shaped filters in mel domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%               'm'  hamming shaped filters in mel domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%               'p'  filters act in the power domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%               'a'  filters act in the absolute magnitude domain (default)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%               '0'  include 0'th order cepstral coefficient</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%               'E'  include log energy</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%               'd'  include delta coefficients (dc/dt)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%               'D'  include delta-delta coefficients (d^2c/dt^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%               'z'  highest and lowest filters taper down to zero (default)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%               'y'  lowest filter remains at 1 down to 0 frequency and</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%                    highest filter remains at 1 up to nyquist freqency</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%              If 'ty' or 'ny' is specified, the total power in the fft is preserved.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">% Outputs:  c     mel cepstrum output: one frame per row. Log energy, if requested, is the</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%                 first element of each row followed by the delta and then the delta-delta</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%                 coefficients.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">% BUGS: (1) should have power limit as 1e-16 rather than 1e-6 (or possibly a better way of choosing this)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%           and put into VOICEBOX</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%       (2) get rdct to change the data length (properly) instead of doing it explicitly (wrongly)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%      Copyright (C) Mike Brookes 1997</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%      Version: $Id: melcepst.m 3497 2013-09-26 16:10:51Z dmb $</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%   VOICEBOX is a MATLAB toolbox for speech processing.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%   Home page: http://www.ee.ic.ac.uk/hp/staff/dmb/voicebox/voicebox.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%   This program is free software; you can redistribute it and/or modify</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%   it under the terms of the GNU General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%   the Free Software Foundation; either version 2 of the License, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%   (at your option) any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%   This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">%   GNU General Public License for more details.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%   You can obtain a copy of the GNU General Public License from</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%   http://www.gnu.org/copyleft/gpl.html or by writing to</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%   Free Software Foundation, Inc.,675 Mass Ave, Cambridge, MA 02139, USA.</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,74" id="srcline74"> 74</a></span><span class="line"><span class="keyword">if</span> nargin&lt;2 <span class="var type0" id="S4T0U23">fs</span>=11025; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,75" id="srcline75"> 75</a></span><span class="line"><span class="keyword">if</span> nargin&lt;3 <span class="var type0" id="S5T0U33">w</span>=<span class="string">'M'</span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,76" id="srcline76"> 76</a></span><span class="line"><span class="keyword">if</span> nargin&lt;4 <span class="var type0" id="S6T0U43">nc</span>=12; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,77" id="srcline77"> 77</a></span><span class="line"><span class="keyword">if</span> nargin&lt;5 <span class="var type0" id="S7T0U53">p</span>=floor(3*log(<span class="var type0" id="S4T0U60">fs</span>)); <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,78" id="srcline78"> 78</a></span><span class="line"><span class="keyword">if</span> nargin&lt;6 <span class="var type0" id="S8T0U69">n</span>=pow2(floor(log2(0.03*<span class="var type0" id="S4T0U78">fs</span>))); <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,79" id="srcline79"> 79</a></span><span class="line"><span class="keyword">if</span> nargin&lt;9</span></span>
<span class="srcline"><span class="lineno"><a href="118,80" id="srcline80"> 80</a></span><span class="line">   <span class="var type0" id="S11T0U87">fh</span>=0.5;   </span></span>
<span class="srcline"><span class="lineno"><a href="118,81" id="srcline81"> 81</a></span><span class="line">   <span class="keyword">if</span> nargin&lt;8</span></span>
<span class="srcline"><span class="lineno"><a href="118,82" id="srcline82"> 82</a></span><span class="line">     <span class="var type0" id="S10T0U97">fl</span>=0;</span></span>
<span class="srcline"><span class="lineno"><a href="118,83" id="srcline83"> 83</a></span><span class="line">     <span class="keyword">if</span> nargin&lt;7</span></span>
<span class="srcline"><span class="lineno"><a href="118,84" id="srcline84"> 84</a></span><span class="line">        <span class="var type0" id="S9T0U107">inc</span>=floor(<span class="var type0" id="S8T0U111">n</span>/2);</span></span>
<span class="srcline"><span class="lineno"><a href="118,85" id="srcline85"> 85</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,86" id="srcline86"> 86</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,87" id="srcline87"> 87</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,89" id="srcline89"> 89</a></span><span class="line"><span class="keyword">if</span> isempty(<span class="var type1" id="S5T8U117">w</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,90" id="srcline90"> 90</a></span><span class="line">   <span class="var type0" id="S5T0U120">w</span>=<span class="string">'M'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,91" id="srcline91"> 91</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,92" id="srcline92"> 92</a></span><span class="line"><span class="keyword">if</span> any(<span class="var type1" id="S5T8U127">w</span>==<span class="string">'R'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,93" id="srcline93"> 93</a></span><span class="line">   <span class="var type0" id="S19T0U131">z</span>=enframe(<span class="var type0" id="S3T0U134">s</span>,<span class="var type0" id="S8T0U135">n</span>,<span class="var type0" id="S9T0U136">inc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,94" id="srcline94"> 94</a></span><span class="line"><span class="keyword">elseif</span> any (<span class="var type1" id="S5T8U141">w</span>==<span class="string">'N'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,95" id="srcline95"> 95</a></span><span class="line">   <span class="var type0" id="S19T0U145">z</span>=enframe(<span class="var type0" id="S3T0U148">s</span>,hanning(<span class="var type0" id="S8T0U151">n</span>),<span class="var type0" id="S9T0U152">inc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,97" id="srcline97"> 97</a></span><span class="line">   <span class="mxinfo" id="T29:U20"><span class="var type1" id="S19T29U156">z</span>=<span class="mxinfo" id="T29:U22"><span class="fcn" id="F85N4:B158">enframe</span>(<span class="var type1" id="S3T1U159">s</span>,<span class="mxinfo" id="T20:U24">hamming(<span class="var type1" id="S8T2U162">n</span>)</span>,<span class="var type1" id="S9T2U163">inc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T66:U27"><span class="var type1" id="S23T66U166">f</span>=<span class="mxinfo" id="T66:U29"><span class="fcn" id="F340N11:B168">rfft</span>(<span class="mxinfo" id="T31:U30"><span class="var type1" id="S19T29U170">z</span>.'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T61:U32">[<span class="var type1" id="S25T61U174">m</span>,<span class="var type1" id="S26T67U175">a</span>,<span class="var type1" id="S27T2U176">b</span>]=<span class="fcn" id="F464N8:B178">melbankm</span>(<span class="var type1" id="S7T2U179">p</span>,<span class="var type1" id="S8T2U180">n</span>,<span class="var type1" id="S4T2U181">fs</span>,<span class="var type1" id="S10T2U182">fl</span>,<span class="var type1" id="S11T2U183">fh</span>,<span class="var type1" id="S5T8U184">w</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo" id="T68:U42"><span class="var type1" id="S29T68U187">pw</span>=<span class="mxinfo" id="T68:U44"><span class="mxinfo" id="T68:U45"><span class="var type1" id="S23T66U190">f</span>(<span class="mxinfo" id="T5:U47"><span class="mxinfo" id="T2:U48">norm(<span class="var type1" id="S26T67U194">a</span>)</span>:<span class="var type1" id="S27T2U195">b</span></span>,:)</span>.*<span class="mxinfo" id="T68:U51">conj(<span class="mxinfo" id="T68:U52"><span class="var type1" id="S23T66U200">f</span>(<span class="mxinfo" id="T5:U54"><span class="mxinfo" id="T2:U55">norm(<span class="var type1" id="S26T67U204">a</span>)</span>:<span class="var type1" id="S27T2U205">b</span></span>,:)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo" id="T42:U58"><span class="var type1" id="S32T42U209">pth</span>=<span class="mxinfo" id="T42:U60"><span class="mxinfo" id="T42:U61">max(<span class="mxinfo" id="T80:U62"><span class="var type1" id="S29T68U214">pw</span>(:)</span>)</span>*<span class="mxinfo" id="T2:U64">1E-20</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,103" id="srcline103">103</a></span><span class="line"><span class="keyword">if</span> any(<span class="var type1" id="S5T8U222">w</span>==<span class="string">'p'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,104" id="srcline104">104</a></span><span class="line">   <span class="var type0" id="S34T0U226">y</span>=log(max(<span class="var type0" id="S25T0U232">m</span>*<span class="var type0" id="S29T0U233">pw</span>,<span class="var type0" id="S32T0U234">pth</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="118,105" id="srcline105">105</a></span><span class="line">   <span class="comment">%size(y)</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,106" id="srcline106">106</a></span><span class="line">   <span class="comment">%disp('Option 1')</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,107" id="srcline107">107</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,108" id="srcline108">108</a></span><span class="line">   <span class="mxinfo" id="T42:U66"><span class="var type1" id="S35T42U238">ath</span>=<span class="mxinfo" id="T42:U68">sqrt(<span class="var type1" id="S32T42U241">pth</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,109" id="srcline109">109</a></span><span class="line">   <span class="mxinfo" id="T64:U70"><span class="var type1" id="S34T64U244">y</span> = <span class="mxinfo" id="T64:U72">zeros(<span class="mxinfo" id="T2:U73">32</span>,<span class="mxinfo" id="T2:U74">306</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,110" id="srcline110">110</a></span><span class="line">   <span class="mxinfo" id="T69:U75"><span class="var type1" id="S34T69U251">y</span>=<span class="mxinfo" id="T69:U77">log(<span class="mxinfo" id="T69:U78">max(<span class="mxinfo" id="T82:U79"><span class="var type1" id="S25T61U257">m</span>*<span class="mxinfo" id="T81:U81">abs(<span class="mxinfo" id="T68:U82"><span class="var type1" id="S23T66U261">f</span>(<span class="mxinfo" id="T5:U84"><span class="mxinfo" id="T2:U85">norm(<span class="var type1" id="S26T67U265">a</span>)</span>:<span class="var type1" id="S27T2U266">b</span></span>,:)</span>)</span></span>,<span class="var type1" id="S35T42U268">ath</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,111" id="srcline111">111</a></span><span class="line">   <span class="comment">%disp('Option 2')</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,112" id="srcline112">112</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo" id="T65:U89"><span class="var type1" id="S2T65U271">c</span>=<span class="mxinfo" id="T65:U91"><span class="mxinfo" id="T82:U92"><span class="fcn" id="F590N10:B274">rdct</span>(<span class="var type1" id="S34T69U275">y</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo" id="T2:U94"><span class="var type1" id="S40T2U278">nf</span>=<span class="mxinfo" id="T2:U96">size(<span class="var type1" id="S2T65U281">c</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T2:U98"><span class="var type1" id="S6T2U285">nc</span>=<span class="mxinfo" id="T2:U100"><span class="var type1" id="S6T2U287">nc</span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,116" id="srcline116">116</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T5:U102"><span class="var type1" id="S7T2U292">p</span>&gt;<span class="mxinfo" id="T2:U104"><span class="var type1" id="S6T2U293">nc</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="118,117" id="srcline117">117</a></span><span class="line">   <span class="mxinfo" id="T65:U106"><span class="var type1" id="S42T65U296">newc</span> = <span class="mxinfo" id="T65:U108"><span class="var type1" id="S2T65U298">c</span>(:,<span class="mxinfo" id="T5:U110"><span class="mxinfo" id="T2:U111"><span class="var type1" id="S6T2U302">nc</span>+1</span>:<span class="mxinfo" id="T2:U113">end</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,118" id="srcline118">118</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T5:U114"><span class="var type1" id="S7T2U308">p</span>&lt;<span class="mxinfo" id="T2:U116"><span class="var type1" id="S6T2U309">nc</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="118,119" id="srcline119">119</a></span><span class="line">   <span class="mxinfo" id="T65:U118"><span class="var type1" id="S42T65U312">newc</span> =<span class="mxinfo" id="T65:U120">[<span class="var type1" id="S2T65U315">c</span> <span class="mxinfo" id="T65:U122">zeros(<span class="var type1" id="S40T2U318">nf</span>,<span class="mxinfo" id="T2:U124"><span class="mxinfo" id="T2:U125"><span class="var type1" id="S6T2U320">nc</span></span>-<span class="var type1" id="S7T2U321">p</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,120" id="srcline120">120</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,121" id="srcline121">121</a></span><span class="line">    <span class="mxinfo" id="T65:U128"><span class="var type1" id="S42T65U325">newc</span> = <span class="var type1" id="S2T65U326">c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,122" id="srcline122">122</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,123" id="srcline123">123</a></span><span class="line"><span class="keyword">if</span> ~any(<span class="var type1" id="S5T8U333">w</span>==<span class="string">'0'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,124" id="srcline124">124</a></span><span class="line">   <span class="mxinfo" id="T65:U132"><span class="var type1" id="S42T65U338">newc</span>(:,1)=[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,125" id="srcline125">125</a></span><span class="line">   <span class="mxinfo" id="T2:U134"><span class="var type1" id="S6T2U345">nc</span>=<span class="mxinfo" id="T2:U136"><span class="var type1" id="S6T2U347">nc</span>-<span class="mxinfo" id="T2:U138">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,126" id="srcline126">126</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,127" id="srcline127">127</a></span><span class="line"><span class="keyword">if</span> any(<span class="var type1" id="S5T8U354">w</span>==<span class="string">'E'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,128" id="srcline128">128</a></span><span class="line">   <span class="var type0" id="S42T0U358">newc</span>=[log(max(sum(<span class="var type0" id="S29T0U368">pw</span>),<span class="var type0" id="S32T0U369">pth</span>)).' <span class="var type0" id="S42T0U370">newc</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="118,129" id="srcline129">129</a></span><span class="line">   <span class="var type0" id="S6T0U373">nc</span>=<span class="var type0" id="S6T0U375">nc</span>+1;</span></span>
<span class="srcline"><span class="lineno"><a href="118,130" id="srcline130">130</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,131" id="srcline131">131</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,132" id="srcline132">132</a></span><span class="line"><span class="comment">% calculate derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,133" id="srcline133">133</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="118,134" id="srcline134">134</a></span><span class="line"><span class="keyword">if</span> any(<span class="var type1" id="S5T8U382">w</span>==<span class="string">'D'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,135" id="srcline135">135</a></span><span class="line">  <span class="var type0" id="S45T0U386">vf</span>=(4:-1:-4)/60;</span></span>
<span class="srcline"><span class="lineno"><a href="118,136" id="srcline136">136</a></span><span class="line">  <span class="var type0" id="S46T0U399">af</span>=(1:-1:-1)/2;</span></span>
<span class="srcline"><span class="lineno"><a href="118,137" id="srcline137">137</a></span><span class="line">  <span class="var type0" id="S47T0U412">ww</span>=ones(5,1);</span></span>
<span class="srcline"><span class="lineno"><a href="118,138" id="srcline138">138</a></span><span class="line">  <span class="var type0" id="S49T0U419">cx</span>=[<span class="var type0" id="S42T0U423">newc</span>(<span class="var type0" id="S47T0U424">ww</span>,:); <span class="var type0" id="S42T0U427">newc</span>; <span class="var type0" id="S42T0U430">newc</span>(<span class="var type0" id="S40T0U432">nf</span>*<span class="var type0" id="S47T0U433">ww</span>,:)];</span></span>
<span class="srcline"><span class="lineno"><a href="118,139" id="srcline139">139</a></span><span class="line">  <span class="var type0" id="S50T0U437">vx</span>=reshape(filter(<span class="var type0" id="S45T0U442">vf</span>,1,<span class="var type0" id="S49T0U445">cx</span>(:)),<span class="var type0" id="S40T0U448">nf</span>+10,<span class="var type0" id="S6T0U450">nc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,140" id="srcline140">140</a></span><span class="line">  <span class="var type0" id="S50T0U454">vx</span>(1:8,:)=[];</span></span>
<span class="srcline"><span class="lineno"><a href="118,141" id="srcline141">141</a></span><span class="line">  <span class="var type0" id="S53T0U463">ax</span>=reshape(filter(<span class="var type0" id="S46T0U468">af</span>,1,<span class="var type0" id="S50T0U471">vx</span>(:)),<span class="var type0" id="S40T0U474">nf</span>+2,<span class="var type0" id="S6T0U476">nc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,142" id="srcline142">142</a></span><span class="line">  <span class="var type0" id="S53T0U480">ax</span>(1:2,:)=[];</span></span>
<span class="srcline"><span class="lineno"><a href="118,143" id="srcline143">143</a></span><span class="line">  <span class="var type0" id="S50T0U490">vx</span>([1 <span class="var type0" id="S40T0U495">nf</span>+2],:)=[];</span></span>
<span class="srcline"><span class="lineno"><a href="118,144" id="srcline144">144</a></span><span class="line">  <span class="keyword">if</span> any(<span class="var type0" id="S5T0U505">w</span>==<span class="string">'d'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,145" id="srcline145">145</a></span><span class="line">     <span class="var type0" id="S42T0U509">newc</span>=[<span class="var type0" id="S42T0U512">newc</span> <span class="var type0" id="S50T0U513">vx</span> <span class="var type0" id="S53T0U514">ax</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="118,146" id="srcline146">146</a></span><span class="line">  <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,147" id="srcline147">147</a></span><span class="line">     <span class="var type0" id="S42T0U518">newc</span>=[<span class="var type0" id="S42T0U521">newc</span> <span class="var type0" id="S53T0U522">ax</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="118,148" id="srcline148">148</a></span><span class="line">  <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,149" id="srcline149">149</a></span><span class="line"><span class="keyword">elseif</span> any(<span class="var type1" id="S5T8U527">w</span>==<span class="string">'d'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="118,150" id="srcline150">150</a></span><span class="line">  <span class="var type0" id="S45T0U531">vf</span>=(4:-1:-4)/60;</span></span>
<span class="srcline"><span class="lineno"><a href="118,151" id="srcline151">151</a></span><span class="line">  <span class="var type0" id="S47T0U544">ww</span>=ones(4,1);</span></span>
<span class="srcline"><span class="lineno"><a href="118,152" id="srcline152">152</a></span><span class="line">  <span class="var type0" id="S49T0U551">cx</span>=[<span class="var type0" id="S42T0U555">newc</span>(<span class="var type0" id="S47T0U556">ww</span>,:); <span class="var type0" id="S42T0U559">newc</span>; <span class="var type0" id="S42T0U562">newc</span>(<span class="var type0" id="S40T0U564">nf</span>*<span class="var type0" id="S47T0U565">ww</span>,:)];</span></span>
<span class="srcline"><span class="lineno"><a href="118,153" id="srcline153">153</a></span><span class="line">  <span class="var type0" id="S50T0U569">vx</span>=reshape(filter(<span class="var type0" id="S45T0U574">vf</span>,1,<span class="var type0" id="S49T0U577">cx</span>(:)),<span class="var type0" id="S40T0U580">nf</span>+8,<span class="var type0" id="S6T0U582">nc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,154" id="srcline154">154</a></span><span class="line">  <span class="var type0" id="S50T0U586">vx</span>(1:8,:)=[];</span></span>
<span class="srcline"><span class="lineno"><a href="118,155" id="srcline155">155</a></span><span class="line">  <span class="var type0" id="S42T0U595">newc</span>=[<span class="var type0" id="S42T0U598">newc</span> <span class="var type0" id="S50T0U599">vx</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="118,156" id="srcline156">156</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="118,157" id="srcline157">157</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="118,158" id="srcline158">158</a></span><span class="line"><span class="keyword">if</span> nargout&lt;1</span></span>
<span class="srcline"><span class="lineno"><a href="118,159" id="srcline159">159</a></span><span class="line">   [<span class="var type0" id="S40T0U609">nf</span>,<span class="var type0" id="S6T0U610">nc</span>]=size(<span class="var type0" id="S42T0U613">newc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,160" id="srcline160">160</a></span><span class="line">   <span class="var type0" id="S55T0U616">t</span>=((0:<span class="var type0" id="S40T0U625">nf</span>-1)*<span class="var type0" id="S9T0U627">inc</span>+(<span class="var type0" id="S8T0U631">n</span>-1)/2)/<span class="var type0" id="S4T0U634">fs</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="118,161" id="srcline161">161</a></span><span class="line">   <span class="var type0" id="S56T0U637">ci</span>=(1:<span class="var type0" id="S6T0U643">nc</span>)-any(<span class="var type0" id="S5T0U647">w</span>==<span class="string">'0'</span>)-any(<span class="var type0" id="S5T0U652">w</span>==<span class="string">'E'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,162" id="srcline162">162</a></span><span class="line">   <span class="var type0" id="S57T0U656">imh</span> = imagesc(<span class="var type0" id="S55T0U659">t</span>,<span class="var type0" id="S56T0U660">ci</span>,<span class="var type0" id="S42T0U662">newc</span>.');</span></span>
<span class="srcline"><span class="lineno"><a href="118,163" id="srcline163">163</a></span><span class="line">   axis(<span class="string">'xy'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,164" id="srcline164">164</a></span><span class="line">   xlabel(<span class="string">'Time (s)'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,165" id="srcline165">165</a></span><span class="line">   ylabel(<span class="string">'Mel-cepstrum coefficient'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="118,166" id="srcline166">166</a></span><span class="line">    <span class="var type0" id="S62T0U677">map</span> = (0:63)'/63;</span></span>
<span class="srcline"><span class="lineno"><a href="118,167" id="srcline167">167</a></span><span class="line">    colormap([<span class="var type0" id="S62T0U690">map</span> <span class="var type0" id="S62T0U691">map</span> <span class="var type0" id="S62T0U692">map</span>]);</span></span>
<span class="srcline"><span class="lineno"><a href="118,168" id="srcline168">168</a></span><span class="line">    colorbar;</span></span>
<span class="srcline"><span class="lineno"><a href="118,169" id="srcline169">169</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="118,170" id="srcline170">170</a></span><span class="line"></span></span>
</pre>

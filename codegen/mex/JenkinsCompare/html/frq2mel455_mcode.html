<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="94,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T41U3">mel</span>,<span class="var type0" id="S3T0U4">mr</span>] = frq2mel(<span class="var type1" id="S4T41U7">frq</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="94,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%FRQ2ERB  Convert Hertz to Mel frequency scale MEL=(FRQ)</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   [mel,mr] = frq2mel(frq) converts a vector of frequencies (in Hz)</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%   to the corresponding values on the Mel scale which corresponds</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%   to the perceived pitch of a tone.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%   mr gives the corresponding gradients in Hz/mel.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="94,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%   The relationship between mel and frq is given by [1]:</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,10" id="srcline10">10</a></span><span class="line"><span class="comment">%   m = ln(1 + f/700) * 1000 / ln(1+1000/700)</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,11" id="srcline11">11</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,12" id="srcline12">12</a></span><span class="line"><span class="comment">%   This means that m(1000) = 1000</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,13" id="srcline13">13</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,14" id="srcline14">14</a></span><span class="line"><span class="comment">%   References:</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,15" id="srcline15">15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,16" id="srcline16">16</a></span><span class="line"><span class="comment">%     [1] J. Makhoul and L. Cosell. "Lpcw: An lpc vocoder with</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,17" id="srcline17">17</a></span><span class="line"><span class="comment">%         linear predictive spectral warping", In Proc IEEE Intl</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,18" id="srcline18">18</a></span><span class="line"><span class="comment">%         Conf Acoustics, Speech and Signal Processing, volume 1,</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,19" id="srcline19">19</a></span><span class="line"><span class="comment">%         pages 466â€“469, 1976. doi: 10.1109/ICASSP.1976.1170013.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,20" id="srcline20">20</a></span><span class="line"><span class="comment">%     [2] S. S. Stevens &amp; J. Volkman "The relation of pitch to</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,21" id="srcline21">21</a></span><span class="line"><span class="comment">%         frequency", American J of Psychology, V 53, p329 1940</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,22" id="srcline22">22</a></span><span class="line"><span class="comment">%     [3] C. G. M. Fant, "Acoustic description &amp; classification</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,23" id="srcline23">23</a></span><span class="line"><span class="comment">%         of phonetic units", Ericsson Tchnics, No 1 1959</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,24" id="srcline24">24</a></span><span class="line"><span class="comment">%         (reprinted in "Speech Sounds &amp; Features", MIT Press 1973)</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,25" id="srcline25">25</a></span><span class="line"><span class="comment">%     [4] S. B. Davis &amp; P. Mermelstein, "Comparison of parametric</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,26" id="srcline26">26</a></span><span class="line"><span class="comment">%         representations for monosyllabic word recognition in</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,27" id="srcline27">27</a></span><span class="line"><span class="comment">%         continuously spoken sentences", IEEE ASSP, V 28,</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,28" id="srcline28">28</a></span><span class="line"><span class="comment">%         pp 357-366 Aug 1980</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,29" id="srcline29">29</a></span><span class="line"><span class="comment">%     [5] J. R. Deller Jr, J. G. Proakis, J. H. L. Hansen,</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,30" id="srcline30">30</a></span><span class="line"><span class="comment">%         "Discrete-Time Processing of Speech Signals", p380,</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,31" id="srcline31">31</a></span><span class="line"><span class="comment">%         Macmillan 1993</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="94,33" id="srcline33">33</a></span><span class="line"><span class="comment">%      Copyright (C) Mike Brookes 1998</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,34" id="srcline34">34</a></span><span class="line"><span class="comment">%      Version: $Id: frq2mel.m 1874 2012-05-25 15:41:53Z dmb $</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,35" id="srcline35">35</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,36" id="srcline36">36</a></span><span class="line"><span class="comment">%   VOICEBOX is a MATLAB toolbox for speech processing.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,37" id="srcline37">37</a></span><span class="line"><span class="comment">%   Home page: http://www.ee.ic.ac.uk/hp/staff/dmb/voicebox/voicebox.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,38" id="srcline38">38</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,39" id="srcline39">39</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,40" id="srcline40">40</a></span><span class="line"><span class="comment">%   This program is free software; you can redistribute it and/or modify</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,41" id="srcline41">41</a></span><span class="line"><span class="comment">%   it under the terms of the GNU General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,42" id="srcline42">42</a></span><span class="line"><span class="comment">%   the Free Software Foundation; either version 2 of the License, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,43" id="srcline43">43</a></span><span class="line"><span class="comment">%   (at your option) any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,44" id="srcline44">44</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,45" id="srcline45">45</a></span><span class="line"><span class="comment">%   This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,46" id="srcline46">46</a></span><span class="line"><span class="comment">%   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,47" id="srcline47">47</a></span><span class="line"><span class="comment">%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,48" id="srcline48">48</a></span><span class="line"><span class="comment">%   GNU General Public License for more details.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,49" id="srcline49">49</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,50" id="srcline50">50</a></span><span class="line"><span class="comment">%   You can obtain a copy of the GNU General Public License from</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,51" id="srcline51">51</a></span><span class="line"><span class="comment">%   http://www.gnu.org/copyleft/gpl.html or by writing to</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,52" id="srcline52">52</a></span><span class="line"><span class="comment">%   Free Software Foundation, Inc.,675 Mass Ave, Cambridge, MA 02139, USA.</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,53" id="srcline53">53</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,54" id="srcline54">54</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S5T2U9">k</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,55" id="srcline55">55</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T7:U4"><span class="mxinfo" id="T7:U5">isempty(<span class="var type0" id="S5T0U14">k</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="94,56" id="srcline56">56</a></span><span class="line">    <span class="mxinfo" id="T2:U6"><span class="var type1" id="S5T2U17">k</span>=<span class="mxinfo" id="T2:U8"><span class="mxinfo" id="T2:U9">1000</span>/<span class="mxinfo" id="T2:U10">log(1+1000/700)</span></span></span>; <span class="comment">%  1127.01048</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,57" id="srcline57">57</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="94,58" id="srcline58">58</a></span><span class="line"><span class="mxinfo" id="T41:U11"><span class="var type1" id="S8T41U29">af</span>=<span class="mxinfo" id="T41:U13">abs(<span class="var type1" id="S4T41U32">frq</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="94,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo" id="T41:U15"><span class="var type1" id="S2T41U35">mel</span> = <span class="mxinfo" id="T41:U17"><span class="mxinfo" id="T41:U18"><span class="mxinfo" id="T41:U19">sign(<span class="var type1" id="S4T41U40">frq</span>)</span>.*<span class="mxinfo" id="T41:U21">log(<span class="mxinfo" id="T41:U22"><span class="mxinfo" id="T2:U23">1</span>+<span class="mxinfo" id="T41:U24"><span class="var type1" id="S8T41U46">af</span>/<span class="mxinfo" id="T2:U26">700</span></span></span>)</span></span>*<span class="var type1" id="S5T2U48">k</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="94,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo" id="T41:U28"><span class="var type1" id="S3T41U51">mr</span>=<span class="mxinfo" id="T41:U30">(<span class="mxinfo" id="T41:U31"><span class="mxinfo" id="T2:U32">700</span>+<span class="var type1" id="S8T41U56">af</span></span>)/<span class="var type1" id="S5T2U57">k</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="94,61" id="srcline61">61</a></span><span class="line"><span class="keyword">if</span> ~nargout</span></span>
<span class="srcline"><span class="lineno"><a href="94,62" id="srcline62">62</a></span><span class="line">    plot(<span class="var type0" id="S4T0U66">frq</span>,<span class="var type0" id="S2T0U67">mel</span>,<span class="string">'-x'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="94,63" id="srcline63">63</a></span><span class="line">    xlabel([<span class="string">'Frequency ('</span> xticksi <span class="string">'Hz)'</span>]);</span></span>
<span class="srcline"><span class="lineno"><a href="94,64" id="srcline64">64</a></span><span class="line">    ylabel([<span class="string">'Frequency ('</span> yticksi <span class="string">'Mel)'</span>]);</span></span>
<span class="srcline"><span class="lineno"><a href="94,65" id="srcline65">65</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>

<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="45,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T62U3">y</span>=rfft(<span class="var type1" id="S3T31U6">x</span>,<span class="var type0" id="S4T0U7">n</span>,<span class="var type0" id="S5T0U8">d</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="45,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%RFFT     Calculate the DFT of real data Y=(X,N,D)</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Data is truncated/padded to length N if specified.</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%   N even: (N+2)/2 points are returned with</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%           the first and last being real</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%   N odd:  (N+1)/2 points are returned with the</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%           first being real</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% In all cases fix(1+N/2) points are returned</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% D is the dimension along which to do the DFT</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="45,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="45,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="45,13" id="srcline13">13</a></span><span class="line"><span class="comment">%      Copyright (C) Mike Brookes 1998</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,14" id="srcline14">14</a></span><span class="line"><span class="comment">%      Version: $Id: rfft.m 713 2011-10-16 14:45:43Z dmb $</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,15" id="srcline15">15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,16" id="srcline16">16</a></span><span class="line"><span class="comment">%   VOICEBOX is a MATLAB toolbox for speech processing.</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,17" id="srcline17">17</a></span><span class="line"><span class="comment">%   Home page: http://www.ee.ic.ac.uk/hp/staff/dmb/voicebox/voicebox.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,18" id="srcline18">18</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,19" id="srcline19">19</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,20" id="srcline20">20</a></span><span class="line"><span class="comment">%   This program is free software; you can redistribute it and/or modify</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,21" id="srcline21">21</a></span><span class="line"><span class="comment">%   it under the terms of the GNU General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,22" id="srcline22">22</a></span><span class="line"><span class="comment">%   the Free Software Foundation; either version 2 of the License, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,23" id="srcline23">23</a></span><span class="line"><span class="comment">%   (at your option) any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,24" id="srcline24">24</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,25" id="srcline25">25</a></span><span class="line"><span class="comment">%   This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,26" id="srcline26">26</a></span><span class="line"><span class="comment">%   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,27" id="srcline27">27</a></span><span class="line"><span class="comment">%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,28" id="srcline28">28</a></span><span class="line"><span class="comment">%   GNU General Public License for more details.</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,29" id="srcline29">29</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,30" id="srcline30">30</a></span><span class="line"><span class="comment">%   You can obtain a copy of the GNU General Public License from</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,31" id="srcline31">31</a></span><span class="line"><span class="comment">%   http://www.gnu.org/copyleft/gpl.html or by writing to</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,32" id="srcline32">32</a></span><span class="line"><span class="comment">%   Free Software Foundation, Inc.,675 Mass Ave, Cambridge, MA 02139, USA.</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,33" id="srcline33">33</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="45,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T32:U3"><span class="var type1" id="S6T32U11">s</span>=<span class="mxinfo" id="T32:U5">size(<span class="var type1" id="S3T31U14">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T2:U7"><span class="var type1" id="S8T2U17">numSamples</span> = <span class="mxinfo" id="T2:U9">512</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,37" id="srcline37">37</a></span><span class="line"><span class="keyword">if</span> prod(<span class="var type1" id="S6T32U24">s</span>)==1</span></span>
<span class="srcline"><span class="lineno"><a href="45,38" id="srcline38">38</a></span><span class="line">    <span class="var type0" id="S2T0U28">y</span>=<span class="var type0" id="S3T0U29">x</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,39" id="srcline39">39</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,40" id="srcline40">40</a></span><span class="line">    <span class="keyword">if</span> nargin &lt;3 || isempty(<span class="var type0" id="S5T0U40">d</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="45,41" id="srcline41">41</a></span><span class="line">        <span class="mxinfo" id="T41:U11"><span class="var type1" id="S5T41U43">d</span>=<span class="mxinfo" id="T41:U13">find(<span class="var type1" id="S6T32U47">s</span>&gt;1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,42" id="srcline42">42</a></span><span class="line">        <span class="keyword">if</span> nargin&lt;2</span></span>
<span class="srcline"><span class="lineno"><a href="45,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo" id="T41:U15"><span class="var type1" id="S4T41U58">n</span>=<span class="mxinfo" id="T41:U17"><span class="var type1" id="S6T32U60">s</span>(<span class="var type1" id="S5T41U61">d</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,44" id="srcline44">44</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,45" id="srcline45">45</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,46" id="srcline46">46</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T7:U20">isempty(<span class="var type1" id="S4T41U66">n</span>)</span> </span></span>
<span class="srcline"><span class="lineno"><a href="45,47" id="srcline47">47</a></span><span class="line">        <span class="mxinfo" id="T41:U22"><span class="var type1" id="S4T41U69">n</span>=<span class="mxinfo" id="T41:U24"><span class="var type1" id="S6T32U71">s</span>(<span class="var type1" id="S5T41U72">d</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,48" id="srcline48">48</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo" id="T48:U27"><span class="var type1" id="S2T48U75">y</span>=<span class="mxinfo" id="T48:U29">fft(<span class="var type1" id="S3T31U78">x</span>,<span class="var type1" id="S8T2U79">numSamples</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="45,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo" id="T58:U32"><span class="var type1" id="S2T58U83">y</span>=<span class="mxinfo" id="T58:U34">reshape(<span class="var type1" id="S2T48U86">y</span>,<span class="mxinfo" id="T2:U36">prod((<span class="mxinfo" id="T41:U37"><span class="var type1" id="S6T32U91">s</span>(<span class="mxinfo" id="T2:U39">1</span>:<span class="mxinfo" id="T2:U40"><span class="mxinfo" id="T2:U41">norm(<span class="var type1" id="S5T41U97">d</span>)</span>-<span class="mxinfo" id="T2:U43">1</span></span>)</span>))</span>,<span class="var type1" id="S8T2U99">numSamples</span>,<span class="mxinfo" id="T2:U45">prod(<span class="mxinfo" id="T41:U46"><span class="var type1" id="S6T32U103">s</span>(<span class="mxinfo" id="T2:U48"><span class="mxinfo" id="T2:U49">norm(<span class="var type1" id="S5T41U108">d</span>)</span>+<span class="mxinfo" id="T2:U51">1</span></span>:<span class="mxinfo" id="T2:U52">end</span>)</span>)</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="45,51" id="srcline51">51</a></span><span class="line">    size(<span class="var type1" id="S2T58U115">y</span>); <span class="comment">%1, 512, 306</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,52" id="srcline52">52</a></span><span class="line">    <span class="mxinfo" id="T41:U54"><span class="mxinfo" id="T41:U55"><span class="var type1" id="S6T32U119">s</span>(<span class="var type1" id="S5T41U120">d</span>)</span>=<span class="mxinfo" id="T41:U58"><span class="mxinfo" id="T2:U59">1</span>+<span class="mxinfo" id="T41:U60">fix(<span class="mxinfo" id="T41:U61"><span class="var type1" id="S4T41U126">n</span>/<span class="mxinfo" id="T2:U63">2</span></span>)</span></span></span>; <span class="comment">%257, 306</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,53" id="srcline53">53</a></span><span class="line">    <span class="mxinfo" id="T58:U64"><span class="var type1" id="S2T58U131">y</span>(:,<span class="mxinfo" id="T41:U66"><span class="mxinfo" id="T2:U67"><span class="mxinfo" id="T2:U68">norm(<span class="mxinfo" id="T41:U69"><span class="var type1" id="S6T32U138">s</span>(<span class="var type1" id="S5T41U139">d</span>)</span>)</span>+<span class="mxinfo" id="T2:U72">1</span></span>:<span class="mxinfo" id="T2:U73">end</span></span>,:)=[]</span>; <span class="comment">%second one is range of rows taken OUT [] DELETES rows specified</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,54" id="srcline54">54</a></span><span class="line">    size(<span class="var type1" id="S2T58U149">y</span>); <span class="comment">%1, 257, 306</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,55" id="srcline55">55</a></span><span class="line">    <span class="mxinfo" id="T62:U75"><span class="var type1" id="S2T62U152">y</span>=<span class="mxinfo" id="T62:U77">reshape(<span class="var type1" id="S2T58U155">y</span>,<span class="var type1" id="S6T32U156">s</span>)</span></span>; <span class="comment">%257, 306</span></span></span>
<span class="srcline"><span class="lineno"><a href="45,56" id="srcline56">56</a></span><span class="line">    size(<span class="var type1" id="S2T62U160">y</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="45,57" id="srcline57">57</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
